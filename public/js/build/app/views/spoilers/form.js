define(["marionette","underscore","text!app/templates/spoilers/form.html","app/models/spoiler"],function(e,t,n,r){"use strict";return Backbone.Marionette.ItemView.extend({events:{"click #save":"onClickSave"},initialize:function(e){this.model=new r},onClickSave:function(e){e.preventDefault(),this.model.on("invalid",function(e,t){$(".alert.alert-danger").addClass("hide"),$("#"+t.name+"Error").removeClass("hide").html(t.error)}),this.model.set({title:$("#title").val(),email:$("#email").val(),description:$("#description").val().replace(/\n/g,"<br />"),category:$("#category option:selected").val(),platform:$("#platform option:selected").val()},{validate:!0});if(this.model.isValid())return this.model.save({},{success:function(){return window.location.hash="newest"},error:function(e,t){alert("error on save, please try again")}})},render:function(){var e=new r,i=t.template($(n).html(),{platforms:e.getPlatformOptions(),categories:e.getCategoryOptions()});return this.$el.html(i),this}})});